<div >
  <!-- Header Section -->
  <div class="command-header">
    <div class="command-title-block">
      <i class="pi pi-cog"></i>
      <div>
        <h2>Equipment Management</h2>
        <p>View & manage equipment inventory across the naval fleet</p>
      </div>
    </div>

    <div class="command-actions">
      <button class="btn primary btn-sm" (click)="goBack()">
        <i class="pi pi-arrow-left"></i> Back
      </button>
      <button class="btn primary btn-sm" (click)="toggleForm(true)">
        <i class="pi pi-plus"></i> Add Equipment
      </button>

      <button class="btn outlined btn-sm">
        <i class="pi pi-upload"></i> Bulk Upload
      </button>

      <div class="menu-group">
        <p-tieredMenu #exportMenu [model]="exportOptions" popup appendTo="body"></p-tieredMenu>
        <button class="btn outlined btn-sm" (click)="exportMenu.toggle($event)">
          <i class="pi pi-file-export"></i> Export
        </button>
      </div>
    </div>
  </div>


<div class="max-w-screen-xl mx-auto">
    <app-paginated-table 
      [columns]="cols" 
      
      [totalCount]="totalCount"
      [data]="staticEquipmentData"
      [showEndActions]="true" 
      (viewEvent)="view($event)"
      (editEvent)="edit($event)" 
      (deleteEvent)="deleteRow($event)"
       >
    </app-paginated-table>
</div>

    
  </div>
 
  
<!-- Delete Confirmation Modal -->
<app-delete-confirmation-modal
  [visible]="showDeleteDialog"
  [message]="'Are you sure you want to delete the equipment ' + (selectedDetails?.name || 'Equipment') + '?'"
  (onConfirm)="confirmDeletion()"
  (onCancel)="cancelDeletion()">
</app-delete-confirmation-modal>

<!-- View Details Component -->
<app-view-details
  *ngIf="viewdisplayModal"
  [open]="viewdisplayModal"
  [viewDetails]="selectedDetails"
  [headers]="equipmentViewConfig"
  (onOpenChange)="viewdisplayModal = $event"
  [title]="'View Equipment Details'"
></app-view-details>

<!-- 
<app-add-form *ngIf="isFormOpen" [open]="isFormOpen" [formConfig]="formConfigForNewDetails" [formData]="newDetails"  
  [fromTitle]="title" (onOpenChange)="isFormOpen = $event" (onSubmit)="handleSubmit($event)"></app-add-form>

    <app-add-form *ngIf="isEditFormOpen" [open]="isEditFormOpen" [formConfig]="formConfigForNewDetails"    
[formData]="selectedDetails" [fromTitle]="editTitle" [isEditMode]="true" (onOpenChange)="isEditFormOpen = $event"  
  (onSubmit)="handleEditSubmit($event)"></app-add-form> -->



<p-dialog [header]="isEdit + ' Equipment Details'" [(visible)]="isFormOpen" [modal]="true" [responsive]="true" [style]="{width: '80vw'}" [baseZIndex]="10000" [draggable]="false" [maximizable]="true" [resizable]="true">

  <div class="p-6 bg-slate-100 shadow-md border border-slate-50 mx-auto">
    <form [formGroup]="equipmentForm" class="space-y-4">

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- Section -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Section <span class="text-red-500">*</span></label>
          <p-dropdown 
            formControlName="section"
            [options]="filteredSection"
            optionLabel="name"
            optionValue="id"
            placeholder="Select section"
            [filter]="true"
            filterBy="name"
            (onChange)="onSectionChange($event)"
            class="w-full border-2 border-gray-500 rounded-sm bg-white">
          </p-dropdown>
        </div>

        <!-- Group -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Group <span class="text-red-500">*</span></label>
          <p-dropdown 
            formControlName="group"
            [options]="filteredGroups"
            optionLabel="name"
            optionValue="id"
            placeholder="Select group"
            [filter]="true"
            filterBy="name"
            (onChange)="onGroupChange($event)"
            class="w-full border-2 border-gray-500 rounded-sm bg-white">
          </p-dropdown>
        </div>

        <!-- Generic Code -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Generic Code</label>
          <input 
            pInputText
            type="text"
            formControlName="generic_code"
            placeholder="Enter code"
            class="w-full p-2 border-2 border-gray-500 rounded-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
        </div>

        <!-- Type -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Type</label>
          <p-dropdown 
            formControlName="type"
            [options]="filteredTypes"
            optionLabel="name"
            optionValue="id"
            placeholder="--Select type--"
            [filter]="true"
            filterBy="name"
            class="w-full border-2 border-gray-500 rounded-sm">
          </p-dropdown>
        </div>

        <!-- Equipment Code -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Equipment Code <span class="text-red-500">*</span></label>
          <div class="flex items-center gap-2">
            <input 
              pInputText
              type="text"
              formControlName="code"
              placeholder="Auto-generated code"
              class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              readonly>
            <div *ngIf="isLoading" class="flex items-center">
              <i class="pi pi-spin pi-spinner text-blue-500"></i>
              <span class="ml-2 text-sm text-gray-500">Generating...</span>
            </div>
          </div>
        </div>

        <!-- Equipment Name -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Equipment Name <span class="text-red-500">*</span></label>
          <input 
            pInputText
            type="text"
            formControlName="name"
            placeholder="Enter equipment name"
            class="w-full p-2 border-2 border-gray-500 rounded-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
        </div>

        <!-- Equipment Model -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Equipment Model</label>
          <input 
            pInputText
            type="text"
            formControlName="model"
            placeholder="Enter model"
            class="w-full p-2 border-2 border-gray-500 rounded-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
        </div>

        <!-- Maintop Number -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Maintop Number</label>
          <input 
            pInputText
            type="text"
            formControlName="maintop_number"
            placeholder="Enter maintop number"
            class="w-full p-2 border-2 border-gray-500 rounded-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
        </div>

        <!-- Acquaint Issued -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Acquaint Issued</label>
          <input 
            pInputText
            type="text"
            formControlName="acquaint_issued"
            placeholder="Enter acquaint issued"
            class="w-full p-2 border-2 border-gray-500 rounded-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
        </div>

        <!-- Authority -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Authority</label>
          <input 
            pInputText
            type="text"
            formControlName="authority"
            placeholder="Enter authority"
            class="w-full p-2 border-2 border-gray-500 rounded-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
        </div>

        <!-- ILMS Equipment Code -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">ILMS Equipment Code</label>
          <input 
            pInputText
            type="text"
            formControlName="ilms_equipment_code"
            placeholder="Enter ILMS equipment code"
            class="w-full p-2 border-2 border-gray-500 rounded-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
        </div>

        <!-- Country -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Country</label>
          <select 
            formControlName="country"
            class="w-full border-2 border-gray-500 rounded-sm py-2 bg-white text-gray-700">
            <option value="" selected>--Select country--</option>
            <option *ngFor="let country of filteredCountries" [value]="country.value">{{ country.label }}</option>
          </select>
        </div>

        <!-- Manufacturer -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Manufacturer</label>
          <div class="flex items-center gap-2">
            <select 
              formControlName="manufacturer"
              class="w-full border-2 border-gray-500 rounded-sm py-2 bg-white text-gray-700">
              <option value="" selected>--Select manufacturer--</option>
              <option *ngFor="let manufacturer of filteredManufacturers" [value]="manufacturer.id">{{ manufacturer.name }}</option>
            </select>
            <!-- <span (click)="addManufacturer()" class="bg-green-100 border-2 py-1 px-2 border-green-500 rounded-sm text-green-600 cursor-pointer text-xs hover:bg-green-500 hover:text-white"><i class="fa fa-plus fa-xs"></i> Add</span> -->
          </div>
        </div>

        <!-- Supplier -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Supplier</label>
          <div class="flex items-center gap-2">
            <select 
              formControlName="supplier"
              class="w-full border-2 border-gray-500 rounded-sm py-2 bg-white text-gray-700">
              <option value="" selected>--Select supplier--</option>
              <option *ngFor="let supplier of filteredSuppliers" [value]="supplier.id">{{ supplier.name }}</option>
            </select>
            <!-- <span (click)="addSupplier()" class="bg-green-100 border-2 py-1 px-2 border-green-500 rounded-sm text-green-600 cursor-pointer text-xs hover:bg-green-500 hover:text-white"><i class="fa fa-plus fa-xs"></i> Add</span> -->
          </div>
        </div>

        <!-- Obsolete -->
        <div class="flex flex-col">
          <label class="text-sm font-semibold text-gray-700 mb-1">Obsolete</label>
          <div class="flex items-center gap-2">
            <input 
              type="checkbox" 
              formControlName="obsolete"
              id="obsolete-checkbox"
              class="h-4 w-4 text-blue-600 border-gray-300 rounded">
            <label for="obsolete-checkbox" class="text-gray-700 text-sm">Obsolete</label>
          </div>
        </div>

      </div>
    </form>

    <!-- Action Buttons -->
    <div class="flex justify-end gap-2 mt-6 pt-4 border-t border-gray-200">
      <button (click)="closeForm()"
        type="button" 
        class="px-6 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 transition-colors duration-200">
        Cancel
      </button>
      <button 
        type="button" 
        class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200"
        (click)="submit()">
        Save
      </button>
    </div>

  </div>
</p-dialog>


<app-add-form [open]="isManufacturerFormOpen" [formConfig]="manufacturerFormConfig" [formData]="newManufacturer" [fromTitle]="'Add New Manufacturer'" (onOpenChange)="isManufacturerFormOpen = $event" (onSubmit)="handleSubmit($event)"></app-add-form>
<app-add-form *ngIf="isSupplierFormOpen" [open]="isSupplierFormOpen" [formConfig]="formConfigForNewDetails" [formData]="newSupplier" [fromTitle]="'Add New Supplier'" (onOpenChange)="isSupplierFormOpen = $event" (onSubmit)="handleSupplierSubmit($event)"></app-add-form>







