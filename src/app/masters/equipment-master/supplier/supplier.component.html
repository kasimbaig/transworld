<div class="">
  <!-- Header Section -->
  <div class="command-header">
    <div class="command-title-block">
      <i class="pi pi-truck"></i>
      <div>
        <h2>Supplier Management</h2>
        <p>View and manage supplier data across the naval fleet</p>
      </div>
    </div>

    <div class="command-actions">
      <button class="btn primary btn-sm" (click)="goBack()">
        <i class="pi pi-arrow-left"></i> Back
      </button>
      <button class="btn primary btn-sm" (click)="toggleForm(true)">
        <i class="pi pi-plus"></i> Add Supplier
      </button>

      <button class="btn outlined btn-sm" (click)="openBulkUpload()">
        <i class="pi pi-upload"></i> Bulk Upload
      </button>

      <div class="menu-group">
        <p-tieredMenu #exportMenu [model]="exportOptions" popup appendTo="body"></p-tieredMenu>
        <button class="btn outlined btn-sm" (click)="exportMenu.toggle($event)">
          <i class="pi pi-file-export"></i> Export
        </button>
      </div>

    </div>

  </div>


 
  <app-paginated-table 
    [columns]="cols" 
    [apiUrl]="apiUrl"
    [totalCount]="totalCount"
     [data]="supplier"
    [showEndActions]="true" 
    (viewEvent)="viewDetails($event)"
    (editEvent)="editDetails($event, true)" 
    (deleteEvent)="deleteDetails($event)"
    (dataLoaded)="onDataLoaded($event)"
      >
  </app-paginated-table>
 

  <!-- Bulk Upload Popup -->
  <p-dialog header="Bulk Upload Suppliers" [(visible)]="isBulkUploadPopup" [style]="{ width: '500px' }">
    <p-fileUpload name="bulkFile" url="api/upload-suppliers" accept=".xlsx,.csv" maxFileSize="1000000"
      (onUpload)="handleBulkUpload($event)" [auto]="true" chooseLabel="Select File" uploadLabel="Upload"></p-fileUpload>
  </p-dialog>

  <!-- Delete Confirmation Modal -->
  <app-delete-confirmation-modal
    [visible]="showDeleteDialog"
    [message]="'Are you sure you want to delete ' + (selectedDetails?.name || 'this supplier') + '?'"
    (onConfirm)="confirmDeletion()"
    (onCancel)="cancelDeletion()">
  </app-delete-confirmation-modal>

  <!-- View Details Component -->
  <app-view-details
    *ngIf="viewdisplayModal"
    [open]="viewdisplayModal"
    [viewDetails]="selectedDetails"
    [headers]="formConfigForNewDetails"
    (onOpenChange)="viewdisplayModal = $event"
    [title]="'View Supplier Details'"
  ></app-view-details>

  <!-- Add Form -->
  <app-add-form *ngIf="isFormOpen" [open]="isFormOpen" [formConfig]="formConfigForNewDetails" [formData]="newSupplier"
    [fromTitle]="title" (onOpenChange)="isFormOpen = $event" (onSubmit)="handleSubmit($event)"></app-add-form>

  <!-- Edit Form -->
  <app-add-form *ngIf="isEditFormOpen" [open]="isEditFormOpen" [formConfig]="formConfigForNewDetails"
    [formData]="selectedDetails" [fromTitle]="editTitle" [isEditMode]="true" (onOpenChange)="isEditFormOpen = $event"
    (onSubmit)="handleEditSubmit($event)"></app-add-form>
</div>